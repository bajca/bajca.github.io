<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bára běží půlmaraton</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>
    <style>
        /* ... (předchozí CSS zůstává stejný) ... */
        .message {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <!-- ... (countdown a Strava sekce zůstávají stejné) ... -->

    <div class="container">
        <h2>Napiš mi vzkaz:</h2>
        <form class="message-form" id="messageForm">
            <div class="form-group">
                <label for="name">Jméno:</label>
                <input type="text" id="name" required>
            </div>
            <div class="form-group">
                <label for="message">Vzkaz:</label>
                <textarea id="message" required></textarea>
            </div>
            <button type="submit">Odeslat vzkaz</button>
        </form>
        <div class="messages" id="messagesList"></div>
    </div>

    <script>
        // Firebase konfigurace - TOTO NAHRAĎTE SVÝMI ÚDAJI z Firebase Console
    const firebaseConfig = {
    apiKey: "AIzaSyBxmVkecFPqe16y0QSfJUzEX-HVTQJHcDQ",
    authDomain: "halfmarathonlfg.firebaseapp.com",
    databaseURL: "https://halfmarathonlfg-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "halfmarathonlfg",
    storageBucket: "halfmarathonlfg.firebasestorage.app",
    messagingSenderId: "576641845481",
    appId: "1:576641845481:web:b9804d22afc2fd3fcf0878",
    measurementId: "G-2EHT70ZT4Y"
    };

        // Inicializace Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const messagesRef = database.ref('messages');

        // Správa vzkazů
        function loadMessages() {
            messagesRef.on('value', (snapshot) => {
                const messages = [];
                snapshot.forEach((childSnapshot) => {
                    messages.push({
                        id: childSnapshot.key,
                        ...childSnapshot.val()
                    });
                });
                
                // Seřazení zpráv od nejnovější
                messages.sort((a, b) => new Date(b.date) - new Date(a.date));
                
                const messagesHTML = messages.map(msg => `
                    <div class="message">
                        <div class="message-header">${msg.name}</div>
                        <div>${msg.message}</div>
                        <div class="message-date">${new Date(msg.date).toLocaleString()}</div>
                    </div>
                `).join('');
                
                document.getElementById('messagesList').innerHTML = messagesHTML;
            });
        }

        function saveMessage(name, message) {
            return messagesRef.push({
                name: name,
                message: message,
                date: new Date().toISOString()
            });
        }

        // Event listener pro formulář
        document.getElementById('messageForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const name = document.getElementById('name').value;
            const message = document.getElementById('message').value;
            
            if (name && message) {
                try {
                    await saveMessage(name, message);
                    this.reset();
                } catch (error) {
                    alert('Nepodařilo se odeslat vzkaz. Zkuste to prosím později.');
                    console.error('Error saving message:', error);
                }
            }
        });

        // Inicializace načtení zpráv
        loadMessages();

        // Countdown funkce zůstává stejná
        function updateCountdown() {
            const targetDate = new Date('2025-04-05T10:00:00');
            const now = new Date();
            const difference = targetDate - now;

            if (difference <= 0) {
                document.querySelector('.countdown-label').innerHTML = '<h2>Závod začal! Držíme palce! 🎉</h2>';
                return;
            }

            const days = Math.floor(difference / (1000 * 60 * 60 * 24));
            const hours = Math.floor((difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((difference % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((difference % (1000 * 60)) / 1000);

            document.getElementById('days').textContent = String(days).padStart(2, '0');
            document.getElementById('hours').textContent = String(hours).padStart(2, '0');
            document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
            document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
        }

        setInterval(updateCountdown, 1000);
        updateCountdown();
    </script>
</body>
</html>